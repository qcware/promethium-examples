import json
import httpx
import os

try:
    import numpy as np
except ImportError:
    raise ImportError("numpy is not installed, run `pip install numpy`.")

from promethium_sdk.utils import (
    base64encode,
    wait_for_workflows_to_complete,
)

foldername = "output"
base_url = os.getenv("PM_API_BASE_URL", "https://api.promethium.qcware.com")
gpu_type = os.getenv("PM_GPU_TYPE", "a100")

if not os.path.exists(foldername):
    os.makedirs(foldername)

monomerA = base64encode(
"""
 N         10.11700000         17.00600000         16.77600000
 N          9.99600000         22.94800000          7.85200000
 C          8.64600000         22.28100000          9.62500000
 C          9.22600000         20.12900000         12.76200000
 C         10.54100000         20.16100000         13.17600000
 C         11.06500000         19.50600000         14.27400000
 C         10.29300000         18.68200000         15.07200000
 C          8.42400000         19.31200000         13.55500000
 C          8.10000000         23.91000000          7.87300000
 C          9.93600000         23.77900000          6.76400000
 C          9.21500000         25.59600000          4.83500000
 C         11.35500000         25.23000000          3.70200000
 C          8.74200000         24.38200000          6.78200000
 C          8.36600000         25.27400000          5.86400000
 C         10.46200000         24.96600000          4.75300000
 N         12.19700000         24.28000000          3.38100000
 N         11.29500000         26.36400000          2.97100000
 C         10.79900000         24.01500000          5.77400000
 C          8.86500000         23.00800000          8.48600000
 S          9.80000000         21.52100000         10.53200000
 C          7.44100000         22.04200000         10.25000000
 C          7.56500000         21.25800000         11.37800000
 C          8.82300000         20.86100000         11.66500000
 C         10.80600000         18.01900000         16.23200000
 N         11.87000000         18.53000000         16.92200000
 C          8.93400000         18.61800000         14.67300000
 H          8.21313544         18.06283862         15.26228649
 H          7.37044033         19.21041242         13.32835389
 H         12.12738877         19.62003795         14.46925535
 H         11.25202855         20.78634029         12.64871473
 H          9.31407261         16.59414544         16.30891279
 H         10.45073756         16.56909545         17.63365803
 H         12.21652713         18.07985435         17.76608127
 H         12.33590841         19.40311160         16.62389073
 H          6.71276317         20.97383029         11.97739290
 H          6.49935028         22.41589466          9.86462881
 H         10.76990793         22.29804382          8.01934848
 H          7.10807106         24.18353413          8.18980017
 H          7.38646871         25.72759819          5.90526739
 H          8.86888138         26.27215008          4.07514972
 H         11.78261005         23.56337344          5.77446965
 H         12.10374781         23.31045617          3.72460306
 H         12.90737636         24.39305455          2.65344231
 H         10.59179213         27.07653055          3.14451585
 H         11.83906612         26.46947156          2.12061252
"""
)
chargeA = 2
fragsA = [[0,23,24,30,31,32,33],[1,8,9,10,12,13,14,17,18,36,37,38,39,40,],[2,19,20,21,22,34,35,],[3,4,5,6,7,25,26,27,28,29,],[11,15,16,41,42,43,44,],]

labelsA = []
for idx in range(len(fragsA)):
    labelsA.append('A%d' % (idx+1))

monomerB = base64encode(
"""
 O         20.75000000         34.93000000         23.60400000
 C         20.02200000         33.72700000         23.79800000
 C         20.99200000         32.58100000         23.67700000
 O         20.38200000         31.40600000         24.24800000
 C         21.35800000         32.20700000         22.24900000
 O         22.73100000         31.73400000         22.28700000
 C         20.34900000         31.10700000         21.92800000
 C         20.25600000         30.39000000         23.26300000
 N         19.02200000         29.65800000         23.57100000
 C         19.08600000         28.38300000         24.17400000
 O         20.19800000         27.90200000         24.43400000
 N         17.93200000         27.77200000         24.52700000
 C         16.75400000         28.34400000         24.22000000
 N         15.62600000         27.70100000         24.55300000
 C         16.67700000         29.62100000         23.59200000
 C         17.81500000         30.21900000         23.26900000
 H         19.21884088         33.61042866         23.05804332
 H         19.55821565         33.68102548         24.79191905
 H         21.90547043         32.82424722         24.22871630
 H         21.29079946         33.06872373         21.57697529
 H         19.41278012         31.57392780         21.64404622
 H         20.67058473         30.46636692         21.11897032
 H         20.11197314         35.67572423         23.61455416
 H         21.07103513         29.64750587         23.35737033
 H         14.72855947         28.10807174         24.34145001
 H         15.67839551         26.83453175         25.10632482
 H         15.72440532         30.07650737         23.37803965
 H         17.83489747         31.18940409         22.79284042
 P         23.55300000         31.50000000         20.95000000
 O         24.95900000         31.99200000         21.17100000
 O         22.72500000         31.92800000         19.81200000
 O         23.57600000         29.92200000         20.81100000
 C         24.21600000         29.18000000         21.80000000
 C         24.14700000         27.73000000         21.41900000
 O         22.83800000         27.20600000         21.73800000
 C         24.36100000         27.46600000         19.94000000
 O         25.34000000         26.44300000         19.94100000
 C         22.96700000         27.18400000         19.42100000
 C         22.29500000         26.55100000         20.61500000
 N         20.84100000         26.70600000         20.67600000
 C         20.09800000         27.81100000         20.33900000
 N         18.82500000         27.66100000         20.58600000
 C         18.74100000         26.42100000         21.20300000
 C         17.61900000         25.71800000         21.71000000
 O         16.43800000         26.07800000         21.73000000
 N         17.97700000         24.48100000         22.22700000
 C         19.25900000         23.99700000         22.29400000
 N         19.41300000         22.80200000         22.81800000
 N         20.31100000         24.63600000         21.81700000
 C         19.98200000         25.83600000         21.30000000
 H         23.74063958         29.32433585         22.77738600
 H         25.26088707         29.49879339         21.90159403
 H         24.90238201         27.16388298         21.97881059
 H         24.77611154         28.34777988         19.44580363
 H         22.52305030         28.15275935         19.22208367
 H         22.92257398         26.59472284         18.51560109
 H         22.49544241         25.46668442         20.65693154
 H         20.55292647         28.67145856         19.87086304
 H         17.21008009         23.91596087         22.64885429
 H         20.34900487         22.43668513         22.86202418
 H         18.62682328         22.23239726         23.14002193
 P         25.95100000         25.87300000         18.59300000
 O         27.38800000         25.74600000         18.87200000
 O         25.45300000         26.68300000         17.46700000
 O         25.31400000         24.42700000         18.51900000
 C         25.47000000         23.51800000         19.59600000
 C         24.35500000         22.50900000         19.49700000
 O         23.12700000         23.20500000         19.64400000
 C         24.22900000         21.85200000         18.12800000
 O         24.97500000         20.66900000         18.18300000
 C         22.75300000         21.56400000         17.99800000
 C         22.10400000         22.39100000         19.08900000
 N         21.07500000         23.28000000         18.59700000
 C         19.75800000         23.03800000         18.96600000
 O         19.49400000         21.99400000         19.54400000
 N         18.80700000         23.93000000         18.62600000
 C         19.13300000         25.03000000         17.95800000
 N         18.15700000         25.88600000         17.65400000
 C         20.47500000         25.29700000         17.55400000
 C         21.40600000         24.41400000         17.91200000
 H         25.42685657         24.03171141         20.56536133
 H         26.45027993         23.02879514         19.52566649
 H         24.46817618         21.72476493         20.25623791
 H         24.58476342         22.52139845         17.34677789
 H         22.36261760         21.85094567         17.02802989
 H         22.51443670         20.51326618         18.12457728
 H         21.62354177         21.76027961         19.84957378
 H         18.37408862         26.74410254         17.17720266
 H         17.21419737         25.73862206         18.03435285
 H         20.70168311         26.18879207         16.99921467
 H         22.46690883         24.52322859         17.68747827
 P         25.15100000         19.75700000         16.85200000
 O         26.31600000         18.88400000         17.10600000
 O         25.12000000         20.62300000         15.67600000
 O         23.82600000         18.87800000         16.87500000
 C         23.61100000         17.95100000         17.94600000
 C         22.29100000         17.25100000         17.77500000
 O         21.23800000         18.24500000         17.76200000
 C         22.17400000         16.49200000         16.45500000
 O         21.58600000         15.24400000         16.80300000
 C         21.36100000         17.42500000         15.57400000
 C         20.46500000         18.14800000         16.57200000
 N         20.12100000         19.49700000         16.16400000
 C         20.93200000         20.39600000         15.53600000
 N         20.35800000         21.54200000         15.31200000
 C         19.07800000         21.38800000         15.82300000
 C         17.96900000         22.28800000         15.82700000
 O         17.90300000         23.44200000         15.40400000
 N         16.84600000         21.69400000         16.37800000
 C         16.78300000         20.41500000         16.84200000
 N         15.62900000         20.04700000         17.39100000
 N         17.82000000         19.59300000         16.90800000
 C         18.91300000         20.12700000         16.34600000
 H         23.64059658         18.47156181         18.90940757
 H         24.42563015         17.20808812         17.95179552
 H         22.13888640         16.54916195         18.60633960
 H         23.16021751         16.31696244         16.02135227
 H         22.06006296         18.13484791         15.14836215
 H         20.80725144         16.93239153         14.78742968
 H         19.51259258         17.61753404         16.73034071
 H         21.96561506         20.15253672         15.31834522
 H         15.98383892         22.26513759         16.35874278
 H         15.59561886         19.13333635         17.80619449
 H         14.76734870         20.57438626         17.25643035
 P         21.35000000         14.10800000         15.72100000
 O         21.25500000         12.79900000         16.43300000
 O         22.28500000         14.34000000         14.59300000
 O         19.85600000         14.37300000         15.27100000
 C         18.87500000         14.25300000         16.27800000
 C         17.58900000         14.78200000         15.72000000
 O         17.72200000         16.19700000         15.45900000
 C         17.23500000         14.13500000         14.38600000
 O         15.92800000         13.68400000         14.63400000
 C         17.39100000         15.26000000         13.38100000
 C         17.05000000         16.45800000         14.24900000
 N         17.55300000         17.70600000         13.73000000
 C         18.78200000         18.00300000         13.22300000
 N         18.90600000         19.24700000         12.83200000
 C         17.65600000         19.79600000         13.08600000
 C         17.12600000         21.07300000         12.88200000
 N         17.80500000         22.07500000         12.33900000
 N         15.82700000         21.26400000         13.19100000
 C         15.15200000         20.28300000         13.76200000
 N         15.53900000         19.02900000         14.00500000
 C         16.82000000         18.86300000         13.64700000
 H         19.15098369         14.81302435         17.17896503
 H         18.75318749         13.20110134         16.57105448
 H         16.76390181         14.61796674         16.41913069
 H         17.88620781         13.29412600         14.15659502
 H         18.43944634         15.31955780         13.10759298
 H         16.80397817         15.15100060         12.48060205
 H         15.96547834         16.58991418         14.39645383
 H         19.56371862         17.24732989         13.17890526
 H         17.40106129         23.00743896         12.27896212
 H         18.79040300         21.94599830         12.15222383
 H         14.10937400         20.52186286         13.99340660
 P         15.15500000         12.82300000         13.53900000
 O         14.68600000         11.59700000         14.19000000
 O         15.99600000         12.76800000         12.31100000
 O         13.80900000         13.67300000         13.35100000
 C         12.87600000         13.95200000         14.40600000
 C         11.84900000         14.95400000         13.89200000
 O         12.46300000         16.20600000         13.46500000
 C         11.13700000         14.42300000         12.64000000
 O          9.76300000         14.66800000         12.83300000
 C         11.80300000         15.14100000         11.49000000
 C         12.22600000         16.46700000         12.06400000
 N         13.46900000         16.99700000         11.48600000
 C         14.69400000         16.38300000         11.37200000
 N         15.62200000         17.14600000         10.85500000
 C         14.99100000         18.37000000         10.68800000
 C         15.45100000         19.60600000         10.20900000
 N         16.70400000         19.83800000          9.81400000
 N         14.56600000         20.62200000         10.15100000
 C         13.31100000         20.39700000         10.56100000
 N         12.76400000         19.28200000         11.04000000
 C         13.66900000         18.29500000         11.08200000
 H         13.40936942         14.35970983         15.27422508
 H         12.37488026         13.02617015         14.71975276
 H         11.11354988         15.15552097         14.67763391
 H         11.31062524         13.34621662         12.55402729
 H         12.65862880         14.58116598         11.14332082
 H         11.11036885         15.27894668         10.66271395
 H         11.47274076         17.26401350         11.93398008
 H         14.80874813         15.34307573         11.66298025
 H         16.97715667         20.78397534          9.52984716
 H         17.38789624         19.08882597          9.83991976
 H         12.65680419         21.27021612         10.48245261
 P          8.63900000         14.13800000         11.78300000
 O          7.40400000         14.05600000         12.56700000
 O          9.16300000         13.03100000         10.99100000
 O          8.50000000         15.35600000         10.77200000
 C          8.20300000         16.67200000         11.27500000
 C          8.36600000         17.68700000         10.17800000
 O          9.77200000         17.83300000          9.92700000
 C          7.70700000         17.35800000          8.84000000
 O          6.56400000         18.22600000          8.73800000
 C          8.80600000         17.58500000          7.82200000
 C          9.86900000         18.34200000          8.61600000
 N         11.23100000         18.13600000          8.17900000
 C         11.96500000         19.22600000          7.75700000
 O         11.49800000         20.35400000          7.66100000
 N         13.27100000         18.95200000          7.44600000
 C         13.90400000         17.74000000          7.53400000
 O         15.08100000         17.65600000          7.22100000
 C         13.06200000         16.62800000          7.92700000
 C         13.64100000         15.25300000          7.96100000
 C         11.79700000         16.88300000          8.26400000
 H          8.87147288         16.92804568         12.10356846
 H          7.17475813         16.68358090         11.65625336
 H          7.95399607         18.64412258         10.53862985
 H          7.38192070         16.31577441          8.81926311
 H          9.19620186         16.64054177          7.45832383
 H          8.46778988         18.17256951          6.97419069
 H          9.68564505         19.42364386          8.58173143
 H         13.84594140         19.74845216          7.11021794
 H         13.04855008         14.62188934          8.61715109
 H         13.64683785         14.81012122          6.96521185
 H         14.66564444         15.27140663          8.32423885
 H         11.12553144         16.09901234          8.58428005
 P          5.52600000         18.16400000          7.54200000
 O          4.27300000         18.85800000          8.05000000
 O          5.51400000         16.82600000          6.97800000
 O          6.18800000         19.10500000          6.44700000
 C          6.33700000         20.48200000          6.72600000
 C          7.22000000         21.10700000          5.67500000
 O          8.52400000         20.52100000          5.73400000
 C          6.74300000         20.89400000          4.24700000
 O          6.17900000         22.15200000          3.87900000
 C          7.99200000         20.50800000          3.46700000
 C          9.11900000         20.70700000          4.46600000
 N         10.25500000         19.77300000          4.35400000
 C         11.51100000         20.27700000          4.07500000
 O         11.70900000         21.44500000          3.78100000
 N         12.51000000         19.34500000          4.04900000
 C         12.38900000         17.98400000          4.30000000
 O         13.38100000         17.27600000          4.31000000
 C         11.04700000         17.52800000          4.56700000
 C         10.81800000         16.07700000          4.83200000
 C         10.06500000         18.42600000          4.58300000
 H          6.78468887         20.62837293          7.71649182
 H          5.35926407         20.97955168          6.73372040
 H          7.28651957         22.18707049          5.85553099
 H          5.98338469         20.10384028          4.20176178
 H          7.92788419         19.46403925          3.17227385
 H          8.13224490         21.09627980          2.57071918
 H          9.54946755         21.71220792          4.34725573
 H         13.45631759         19.68525982          3.73838777
 H          9.83720471         15.91909983          5.26923323
 H         10.88068312         15.49594352          3.91317807
 H         11.57644654         15.69964745          5.51237486
 H          9.03589801         18.13910680          4.78313995
 P          5.69800000         22.43500000          2.37200000
 O          4.73900000         23.59500000          2.45000000
 O          5.35600000         21.20600000          1.67800000
 O          6.98400000         23.01300000          1.63500000
 C          7.67500000         24.13800000          2.19000000
 C          8.88900000         24.41000000          1.34600000
 O          9.81800000         23.30600000          1.50200000
 C          8.59600000         24.52400000         -0.14700000
 O          9.08000000         25.81900000         -0.47300000
 C          9.48200000         23.48200000         -0.81300000
 C         10.48000000         23.09600000          0.25700000
 N         10.87900000         21.69400000          0.27000000
 C         12.23000000         21.32600000          0.13500000
 O         13.05900000         22.18800000         -0.17600000
 N         12.58300000         20.02900000          0.32100000
 C         11.65600000         19.12800000          0.65400000
 N         12.04400000         17.87600000          0.87100000
 C         10.27100000         19.46600000          0.73000000
 C          9.93300000         20.75100000          0.54800000
 H          7.95744036         23.93359186          3.22907352
 H          7.00586150         25.00967758          2.19070047
 H          9.36596759         25.34157405          1.66301755
 H          7.54027928         24.40966237         -0.41156990
 H          8.90137904         22.62204375         -1.12675777
 H          9.99084752         23.87141632         -1.69264956
 H         11.41684199         23.66712857          0.17186541
 H         11.33984571         17.15167303          0.94795042
 H         13.04023987         17.61933848          0.79348101
 H          9.53737283         18.71739730          0.96356376
 H          8.90255020         21.09363889          0.57338646
 P          8.65400000         26.56100000         -1.82800000
 O          8.78400000         28.02000000         -1.58000000
 O          7.41500000         25.99300000         -2.34900000
 O          9.76200000         26.10800000         -2.88900000
 C         11.13700000         26.38800000         -2.74700000
 C         11.86100000         25.54700000         -3.77000000
 O         11.82900000         24.17000000         -3.30500000
 C         11.21900000         25.49400000         -5.16400000
 O         12.22100000         25.39600000         -6.17700000
 C         10.53800000         24.13000000         -5.21400000
 C         11.52300000         23.33900000         -4.38700000
 N         11.11800000         22.04100000         -3.85400000
 C          9.86900000         21.55600000         -3.55100000
 N          9.89400000         20.33000000         -3.10400000
 C         11.24000000         20.00000000         -3.08500000
 C         11.87900000         18.78100000         -2.74700000
 O         11.37700000         17.75700000         -2.30000000
 N         13.25800000         18.85500000         -2.91800000
 C         13.92400000         19.95000000         -3.42300000
 N         15.24900000         19.82400000         -3.55600000
 N         13.33500000         21.10200000         -3.72200000
 C         12.00200000         21.03300000         -3.58700000
 H         11.49705849         26.12605578         -1.74212204
 H         11.33379958         27.45595474         -2.91848829
 H         12.90002755         25.88095247         -3.83728135
 H         10.53568222         26.32531019         -5.35266659
 H          9.55247199         24.14442120         -4.76644815
 H         10.46556870         23.77587040         -6.23481802
 H         12.41906018         23.14022652         -4.99696948
 H          8.97767546         22.13758181         -3.72758045
 H         13.80963347         18.00335358         -2.72061948
 H         15.72837058         20.60184111         -3.98596728
 H         15.76687292         18.93822980         -3.43160804
 P         12.63400000         26.68000000         -7.07900000
 O         12.37700000         27.89400000         -6.26000000
 O         11.95500000         26.51400000         -8.35400000
 O         14.20000000         26.44800000         -7.24200000
 C         15.05800000         26.45400000         -6.10800000
 C         16.15100000         25.41700000         -6.27200000
 O         15.64500000         24.07400000         -6.06000000
 C         16.78900000         25.39000000         -7.65400000
 O         18.17600000         25.19000000         -7.43600000
 C         16.11100000         24.22100000         -8.36900000
 C         15.90100000         23.24100000         -7.22000000
 N         14.78100000         22.32000000         -7.30400000
 C         14.97400000         20.99400000         -6.87700000
 O         16.11400000         20.62800000         -6.57600000
 N         13.90000000         20.18000000         -6.75600000
 C         12.67800000         20.63600000         -7.03000000
 N         11.64400000         19.80800000         -6.85100000
 C         12.45600000         21.97500000         -7.47400000
 C         13.52000000         22.78100000         -7.55400000
 H         14.50071012         26.20129479         -5.19953979
 H         15.49838220         27.45072042         -5.98034195
 H         16.92735935         25.61871624         -5.52457054
 H         16.62052923         26.31221890         -8.20909066
 H         15.17741310         24.56860404         -8.80020883
 H         16.72598890         23.80999537         -9.15994707
 H         16.78641229         22.60545755         -7.05332907
 H         10.71080852         20.14252330         -7.04023785
 H         11.76948400         18.89754913         -6.38572094
 H         11.46229043         22.33504918         -7.67884501
 H         13.43222654         23.82903534         -7.82840744
 P         19.23200000         25.37600000         -8.66200000
 O         20.51500000         25.67900000         -8.03300000
 O         18.62900000         26.25500000         -9.70800000
 O         19.31200000         23.93600000         -9.32700000
 C         20.15200000         22.92800000         -8.70000000
 C         20.08000000         21.68900000         -9.56200000
 O         18.77400000         21.10300000         -9.45500000
 C         20.27300000         21.97000000        -11.05600000
 O         21.52000000         21.38800000        -11.44100000
 C         19.06600000         21.34400000        -11.74800000
 C         18.39200000         20.51500000        -10.67700000
 N         16.94400000         20.51800000        -10.68400000
 C         16.10200000         21.60300000        -10.80000000
 N         14.84500000         21.29200000        -10.62200000
 C         14.87300000         19.95000000        -10.26500000
 C         13.81800000         19.05400000         -9.93400000
 O         12.60200000         19.27000000         -9.89900000
 N         14.29500000         17.78500000         -9.65100000
 C         15.59900000         17.39700000         -9.72400000
 N         15.84500000         16.11400000         -9.47200000
 N         16.59000000         18.20700000        -10.04700000
 C         16.16200000         19.46300000        -10.28900000
 H         19.79295473         22.70951746         -7.68537594
 H         21.18828430         23.28484966         -8.63109160
 H         20.85578936         20.98978153         -9.23149597
 H         20.28954121         23.04777345        -11.23698828
 H         18.38253344         22.09883395        -12.11386150
 H         19.35563563         20.72408526        -12.58666612
 H         21.71111619         21.60179637        -12.37554437
 H         18.70833381         19.46192166        -10.72766913
 H         16.48805849         22.58140713        -11.06850224
 H         13.58754194         17.08103636         -9.38757029
 H         16.80106356         15.80758168         -9.51897447
 H         15.08985097         15.43853988         -9.30197367
 H         22.97827477         32.22983002         18.92145191
 H         25.85149146         27.01087121         16.64506157
 H         25.33950961         20.50475672         14.73989464
 H         22.74844072         13.83632863         13.90792783
 H         16.02099852         12.07610291         11.61926514
 H          8.90601535         12.11373971         10.79506314
 H          4.84887981         16.11266893          6.95134003
 H          4.59386202         20.79601134          1.24745283
 H          6.57504497         26.35277698         -2.68102185
 H         12.13015158         28.80226690         -6.51303876
 H         19.12265180         26.84503357        -10.30978262
 O          8.66700000         10.88000000         -8.98000000
 C          9.49400000         10.11800000         -9.86900000
 C         10.94200000         10.28000000         -9.46900000
 O         11.39500000         11.63300000         -9.69300000
 C         11.27200000          9.94900000         -8.02000000
 O         12.42500000          9.09800000         -8.00600000
 C         11.46400000         11.30000000         -7.35800000
 C         11.97400000         12.18000000         -8.52500000
 N         11.61600000         13.61300000         -8.50900000
 C         12.58200000         14.60500000         -8.79200000
 O         13.75400000         14.27800000         -8.93800000
 N         12.20800000         15.88700000         -8.86300000
 C         10.93300000         16.22200000         -8.65700000
 N         10.62000000         17.51400000         -8.71100000
 C          9.92400000         15.24400000         -8.41100000
 C         10.30100000         13.96300000         -8.36800000
 H          9.39166984         10.48654270        -10.89753013
 H          9.22710785          9.05612257         -9.87130275
 H         11.54584851          9.61126364        -10.10076661
 H         10.43867846          9.42092169         -7.55348955
 H         10.52431326         11.66182268         -6.95129116
 H         12.20340143         11.24938408         -6.56282155
 H          7.73028730         10.69074040         -9.19631965
 H         13.07718939         12.17672346         -8.57547741
 H          9.65987440         17.79492483         -8.60000905
 H         11.29914645         18.18932408         -9.07174599
 H          8.89487020         15.54532237         -8.31451109
 H          9.58725297         13.14139403         -8.25261331
 P         12.81500000          8.32000000         -6.66900000
 O         13.25500000          6.93300000         -7.05100000
 O         11.73200000          8.51500000         -5.69200000
 O         14.02000000          9.20900000         -6.10200000
 C         15.13400000          9.40100000         -6.95900000
 C         15.97800000         10.51900000         -6.40800000
 O         15.32100000         11.79300000         -6.62800000
 C         16.24700000         10.41700000         -4.91000000
 O         17.65100000         10.19800000         -4.81600000
 C         15.72700000         11.71000000         -4.32600000
 C         15.64100000         12.62800000         -5.53300000
 N         14.56500000         13.59200000         -5.44000000
 C         13.26300000         13.32500000         -5.10200000
 N         12.50200000         14.38100000         -5.12900000
 C         13.35100000         15.40600000         -5.53500000
 C         13.10600000         16.78300000         -5.69700000
 O         12.03500000         17.37600000         -5.61900000
 N         14.24900000         17.46400000         -6.10000000
 C         15.48000000         16.90200000         -6.27100000
 N         16.47000000         17.72700000         -6.63200000
 N         15.73000000         15.61100000         -6.08700000
 C         14.63000000         14.93900000         -5.71000000
 H         14.81235729          9.64518733         -7.98089014
 H         15.74460655          8.48711535         -7.00869672
 H         16.94545846         10.50935007         -6.92165424
 H         15.72511641          9.56103535         -4.47113757
 H         14.75432969         11.57323941         -3.87278771
 H         16.39993604         12.10233002         -3.58176386
 H         16.57468617         13.19213835         -5.69409984
 H         12.94452193         12.32078994         -4.85888144
 H         14.11969577         18.47688510         -6.31842150
 H         17.39308050         17.34834467         -6.76337740
 H         16.32447091         18.73893470         -6.68504834
 P         18.36100000         10.11100000         -3.37600000
 O         19.58800000          9.26600000         -3.62400000
 O         17.34500000          9.76800000         -2.35900000
 O         18.87000000         11.58600000         -3.09800000
 C         19.79100000         12.25000000         -3.98800000
 C         19.73100000         13.74200000         -3.77600000
 O         18.39200000         14.16400000         -4.03300000
 C         20.00700000         14.20500000         -2.35600000
 O         21.42500000         14.37700000         -2.20800000
 C         19.33500000         15.56300000         -2.36900000
 C         18.19400000         15.40200000         -3.34800000
 N         16.87400000         15.38800000         -2.73700000
 C         16.08300000         16.51500000         -2.85500000
 O         16.59700000         17.55600000         -3.25800000
 N         14.81000000         16.47900000         -2.44800000
 C         14.31000000         15.35800000         -1.93100000
 N         13.04700000         15.37000000         -1.55200000
 C         15.09900000         14.19100000         -1.76000000
 C         16.36700000         14.24700000         -2.18100000
 H         19.52678507         12.00903246         -5.02902563
 H         20.80769260         11.87055125         -3.80909312
 H         20.44332158         14.24541641         -4.44107908
 H         19.58400247         13.52880298         -1.61167826
 H         18.93364851         15.84794030         -1.39970363
 H         20.01545480         16.34145729         -2.69181405
 H         18.15910807         16.24506393         -4.05925212
 H         12.62792727         14.54587531         -1.15027307
 H         12.44571144         16.18336237         -1.75210396
 H         14.69191797         13.30469692         -1.30341737
 H         17.06214260         13.40721680         -2.12011914
 P         22.08700000         14.68000000         -0.78000000
 O         23.50500000         14.24000000         -0.84000000
 O         21.21600000         14.20900000          0.32900000
 O         22.06900000         16.26200000         -0.68400000
 C         22.73400000         17.09000000         -1.64200000
 C         22.39000000         18.53400000         -1.38300000
 O         20.95000000         18.70000000         -1.47100000
 C         22.80700000         19.06800000         -0.00900000
 O         23.15700000         20.41500000         -0.24300000
 C         21.54100000         18.90400000          0.81400000
 C         20.43700000         19.11800000         -0.18500000
 N         19.21700000         18.36000000          0.10700000
 C         19.10600000         17.10200000          0.64300000
 N         17.86700000         16.73900000          0.85200000
 C         17.11700000         17.83900000          0.47100000
 C         15.71200000         18.02000000          0.42900000
 O         14.82400000         17.24200000          0.79200000
 N         15.37400000         19.30100000          0.00500000
 C         16.26700000         20.23700000         -0.46100000
 N         15.74000000         21.37900000         -0.88300000
 N         17.58200000         20.04800000         -0.50400000
 C         17.93000000         18.83400000         -0.03400000
 H         22.39315793         16.82545753         -2.65468662
 H         23.81702504         16.91451594         -1.60248643
 H         22.87761687         19.14832135         -2.14997074
 H         23.65299621         18.52095729          0.42169673
 H         21.50681718         17.90409372          1.23089648
 H         21.47428586         19.59618241          1.64425461
 H         20.12577889         20.17216350         -0.24789813
 H         19.97959163         16.48606629          0.80649692
 H         14.37568168         19.55256366          0.03535858
 H         16.36914869         22.08274464         -1.23367860
 H         14.74909884         21.59382254         -0.76471046
 P         23.21800000         21.54600000          0.92000000
 O         24.27900000         22.49700000          0.53100000
 O         23.28600000         20.89500000          2.22700000
 O         21.84400000         22.31400000          0.70500000
 C         21.45500000         22.85200000         -0.56100000
 C         20.25600000         23.74500000         -0.37700000
 O         19.11600000         22.94700000          0.07000000
 C         20.44200000         24.82600000          0.68600000
 O         19.76300000         26.00000000          0.25300000
 C         19.81400000         24.22600000          1.93200000
 C         18.68500000         23.37100000          1.37000000
 N         18.36200000         22.15300000          2.10300000
 C         19.23900000         21.17700000          2.50100000
 N         18.66400000         20.11300000          3.01200000
 C         17.30900000         20.42600000          2.97400000
 C         16.15700000         19.70800000          3.37100000
 N         16.19300000         18.46800000          3.86000000
 N         14.95800000         20.30100000          3.18000000
 C         14.92300000         21.53700000          2.66400000
 N         15.93700000         22.30300000          2.23100000
 C         17.11200000         21.69200000          2.44500000
 H         21.21865689         22.04590249         -1.26561818
 H         22.29355347         23.42539991         -0.97645671
 H         20.00706164         24.20962684         -1.33999773
 H         21.50312157         25.03647798          0.84406894
 H         20.55250968         23.58522458          2.40448247
 H         19.46270807         24.96456417          2.63935004
 H         17.74443725         23.94356212          1.31312096
 H         20.30240112         21.29883616          2.33067123
 H         15.33374895         17.93122845          3.97653162
 H         17.07127847         17.97102327          3.88195178
 H         13.92497841         21.96387184          2.55852174
 P         19.81600000         27.36100000          1.14300000
 O         19.76800000         28.51400000          0.22100000
 O         20.87400000         27.20500000          2.18000000
 O         18.48500000         27.24300000          2.01200000
 C         17.19500000         27.27700000          1.40800000
 C         16.16100000         27.00300000          2.47500000
 O         16.30300000         25.64900000          2.97800000
 C         16.25500000         27.92500000          3.69500000
 O         15.06700000         28.70200000          3.61900000
 C         16.39300000         26.98200000          4.89100000
 C         15.88800000         25.65000000          4.34600000
 N         16.40900000         24.42600000          4.94500000
 C         17.72400000         24.05400000          5.05600000
 N         17.90100000         22.85900000          5.55900000
 C         16.60900000         22.41400000          5.81500000
 C         16.11100000         21.20600000          6.33300000
 N         16.87800000         20.18000000          6.67500000
 N         14.77200000         21.09400000          6.48000000
 C         14.00400000         22.07100000          6.02400000
 N         14.34900000         23.27300000          5.57000000
 C         15.68200000         23.36800000          5.44500000
 H         17.12646742         26.51695564          0.61579109
 H         16.99535290         28.26095039          0.95961190
 H         15.16326996         27.14053028          2.04457860
 H         17.12356833         28.59142624          3.62500846
 H         17.44400347         26.88964934          5.14714250
 H         15.84874792         27.32565653          5.76256658
 H         14.79161050         25.58646608          4.43997946
 H         18.51943842         24.71687906          4.73654129
 H         16.43847693         19.30146091          6.96200645
 H         17.87526819         20.21110982          6.51091636
 H         12.93155000         21.88147190          6.10343870
 P         14.73800000         29.81800000          4.75500000
 O         13.90100000         30.85900000          4.12100000
 O         15.95800000         30.10000000          5.51700000
 O         13.80700000         29.01400000          5.77000000
 C         12.61700000         28.38400000          5.31200000
 C         12.10500000         27.47200000          6.40400000
 O         13.04900000         26.39200000          6.67200000
 C         11.90900000         28.17000000          7.74700000
 O         10.50400000         28.30500000          7.88900000
 C         12.62200000         27.27500000          8.75000000
 C         12.86200000         25.98700000          7.99700000
 N         14.04100000         25.19500000          8.42000000
 C         13.82500000         23.89600000          8.83700000
 O         12.71700000         23.40800000          8.97800000
 N         14.95700000         23.19600000          9.11800000
 C         16.26000000         23.61400000          8.95600000
 O         17.17400000         22.85300000          9.24300000
 C         16.41800000         24.99900000          8.54800000
 C         17.79300000         25.55400000          8.36300000
 C         15.31400000         25.69200000          8.25300000
 H         12.84104713         27.80109163          4.41232543
 H         11.85150974         29.13136388          5.05887435
 H         11.13345848         27.04761072          6.12778953
 H         12.36652287         29.16013217          7.74532716
 H         13.56043120         27.71545419          9.06535254
 H         12.02371572         27.10367103          9.63783349
 H         11.99940240         25.30915880          8.09507110
 H         14.81366042         22.23038871          9.48104914
 H         17.76244362         26.43821404          7.73660608
 H         18.23071233         25.83666741          9.32209983
 H         18.45799142         24.81520242          7.92354614
 H         15.36966041         26.70656160          7.88054436
 P          9.88100000         28.95300000          9.18100000
 O          8.49200000         29.35400000          8.87800000
 O         10.87700000         29.84800000          9.86300000
 O          9.82400000         27.73900000         10.19100000
 C          9.01500000         26.63500000          9.84600000
 C          9.18700000         25.57200000         10.89500000
 O         10.54700000         25.11100000         10.89400000
 C          8.89500000         26.03200000         12.32600000
 O          7.72300000         25.31000000         12.64900000
 C         10.15100000         25.68300000         13.11100000
 C         10.85700000         24.67400000         12.20900000
 N         12.28700000         24.65100000         12.30900000
 C         12.94100000         23.46900000         12.58200000
 O         12.35800000         22.45800000         12.89700000
 N         14.30800000         23.55500000         12.55300000
 C         15.07100000         24.66100000         12.21500000
 O         16.29900000         24.57700000         12.16800000
 C         14.32100000         25.87400000         11.97600000
 C         15.05800000         27.12400000         11.61700000
 C         12.98400000         25.79700000         12.00000000
 H          9.30868249         26.22338997          8.87170879
 H          7.96116298         26.93633073          9.77521985
 H          8.51305923         24.73632767         10.68437457
 H          8.70207038         27.10599853         12.36931933
 H         10.73842116         26.57051587         13.29493941
 H          9.90734084         25.23971811         14.07252918
 H         10.48902379         23.65861728         12.40696903
 H         14.84562755         22.69429476         12.79598052
 H         16.03620951         27.11201400         12.09212836
 H         15.21434493         27.20091807         10.54385438
 H         14.52237151         28.00833844         11.94280501
 H         12.35809127         26.64111552         11.74506403
 P          6.93700000         25.51300000         14.05400000
 O          5.55300000         25.04300000         13.83900000
 O          7.25900000         26.83700000         14.60100000
 O          7.69100000         24.53100000         15.04700000
 C          7.66600000         23.13800000         14.74900000
 C          8.60600000         22.40400000         15.66600000
 O          9.95700000         22.76600000         15.36300000
 C          8.42500000         22.72100000         17.14500000
 O          7.81600000         21.56400000         17.63700000
 C          9.85200000         22.90100000         17.65600000
 C         10.73000000         22.47600000         16.51000000
 N         11.98200000         23.21500000         16.37300000
 C         13.20700000         22.50700000         16.39900000
 O         13.20600000         21.30000000         16.70400000
 N         14.35500000         23.17700000         16.13600000
 C         14.31800000         24.47300000         15.83200000
 N         15.46500000         25.07000000         15.51600000
 C         13.09500000         25.20400000         15.77400000
 C         11.96100000         24.54500000         16.07400000
 H          7.98286863         22.96643927         13.71160827
 H          6.64498628         22.75376403         14.85643943
 H          8.44573466         21.32885637         15.53603463
 H          7.81997576         23.61057017         17.31525174
 H         10.03485324         23.94342217         17.89493580
 H         10.03257195         22.33738347         18.56623852
 H         10.99756667         21.41441149         16.57617279
 H         15.50512325         26.06521064         15.35279638
 H         16.35056168         24.54408372         15.52946828
 H         13.08350827         26.24639091         15.50696731
 H         10.98328287         25.01663125         16.05305531
 P          7.20700000         21.51600000         19.09700000
 O          6.31100000         20.32800000         19.16200000
 O          6.78900000         22.83700000         19.50300000
 O          8.48300000         21.24000000         20.02500000
 C          9.03400000         19.93900000         20.04900000
 C         10.27300000         19.93400000         20.91200000
 O         11.27300000         20.77000000         20.28500000
 C         10.02800000         20.54500000         22.28300000
 O         10.82000000         19.88100000         23.26000000
 C         10.59400000         21.93900000         22.16400000
 C         11.78600000         21.61700000         21.30200000
 N         12.41700000         22.73900000         20.65900000
 C         11.85400000         23.91800000         20.25000000
 N         12.70500000         24.71700000         19.67000000
 C         13.90800000         24.01800000         19.72000000
 C         15.18000000         24.36100000         19.24000000
 O         15.52100000         25.39700000         18.68700000
 N         16.10400000         23.34700000         19.46200000
 C         15.84100000         22.15000000         20.04900000
 N         16.87400000         21.29700000         20.18200000
 N         14.65300000         21.81900000         20.51500000
 C         13.73200000         22.77800000         20.27500000
 H          9.31833789         19.62320249         19.03484732
 H          8.30184044         19.21714933         20.43536095
 H         10.63055570         18.90398739         21.02774184
 H          8.96777136         20.52661701         22.54325712
 H          9.90743374         22.58337136         21.62250491
 H         10.84088861         22.37842380         23.12394709
 H         12.57361839         21.11036511         21.88406045
 H         10.79982382         24.12068360         20.38829974
 H         17.07672217         23.55167005         19.15046369
 H         16.70317989         20.45333372         20.70103002
 H         17.84807185         21.56395380         19.94263842
 P         10.29400000         19.74100000         24.75500000
 O          9.27200000         18.64900000         24.79100000
 O         10.05900000         21.09800000         25.32800000
 O         11.58000000         19.07700000         25.42100000
 C         12.14600000         17.83600000         24.95300000
 C         13.65000000         17.95900000         24.82600000
 O         13.97500000         18.88200000         23.78000000
 C         14.36100000         18.53100000         26.04000000
 O         14.73500000         17.46600000         26.86200000
 C         15.64900000         19.06100000         25.45600000
 C         15.19900000         19.54600000         24.13200000
 N         14.96300000         20.96700000         24.04500000
 C         16.03200000         21.75200000         23.66900000
 O         17.13400000         21.20800000         23.54700000
 N         15.81700000         23.05500000         23.36100000
 C         14.60300000         23.58200000         23.53200000
 N         14.43000000         24.86800000         23.26700000
 C         13.53100000         22.82700000         24.08500000
 C         13.73800000         21.52700000         24.27500000
 H         11.72740252         17.55298333         23.97747957
 H         11.90023769         17.04034067         25.67106566
 H         14.05819422         16.96376072         24.60567755
 H         13.77384703         19.29255595         26.56718242
 H         16.10966454         19.83520999         26.05047637
 H         16.35309570         18.23920003         25.37415262
 H         15.96261789         19.36500747         23.36190003
 H         13.50742869         25.26165643         23.31438238
 H         15.16711592         25.40558225         22.77960462
 H         12.58067532         23.27307134         24.30613990
 H         12.98032664         20.84710754         24.65449974
 P         15.08500000         17.75600000         28.39700000
 O         15.12300000         16.41400000         29.01200000
 O         14.23300000         18.83100000         28.91900000
 O         16.61900000         18.25000000         28.37300000
 C         17.70100000         17.38100000         28.03600000
 C         18.94500000         18.21600000         27.80900000
 O         18.71100000         19.15200000         26.73600000
 C         19.34900000         19.08300000         29.00000000
 O         20.15200000         18.34200000         29.92100000
 C         20.12700000         20.20200000         28.34100000
 C         19.37000000         20.41100000         27.05300000
 N         18.34400000         21.44700000         27.05700000
 C         17.03600000         21.31500000         27.45000000
 N         16.32100000         22.38700000         27.23300000
 C         17.20900000         23.27900000         26.65200000
 C         17.00300000         24.59600000         26.17500000
 O         15.95600000         25.24000000         26.15700000
 N         18.16200000         25.12900000         25.61100000
 C         19.39400000         24.52300000         25.64500000
 N         20.41200000         25.21800000         25.17200000
 N         19.59900000         23.28900000         26.09400000
 C         18.46800000         22.72400000         26.55300000
 H         17.45602646         16.80764919         27.13409253
 H         17.87530649         16.66849355         28.85371187
 H         19.78474152         17.56603550         27.54160012
 H         18.47452729         19.47951266         29.52102774
 H         20.13425188         21.10579244         28.94529345
 H         21.15005881         19.90989019         28.12694435
 H         20.69093359         17.69063265         29.42657949
 H         20.05179495         20.69074972         26.23549879
 H         16.69720337         20.41352889         27.94886438
 H         18.08328851         26.08462030         25.22061635
 H         21.31803616         24.78399082         25.17368591
 H         20.32956934         26.20218544         24.88879369
 H         11.28631723          8.01066967         -4.99995029
 H         17.45479848          9.53266609         -1.42436421
 H         21.47427503         13.89496134          1.21489661
 H         23.59704286         21.14421273          3.11475130
 H         21.80766569         27.45290733          2.17809521
 H         16.12879248         30.81129201          6.15782230
 H         11.04454578         30.79472827          9.72029920
 H          6.66607371         27.60993323         14.65371128
 H          6.07387593         23.49257452         19.52170222
 H          9.76480233         21.37232992         26.21945081
 H         14.63041033         15.96656378         29.71341988
"""
)
chargeB = 0
fragsB = [[0,22,],[1,2,3,4,6,7,16,17,18,19,20,21,23,],[5,28,29,30,31,379,],[8,9,10,11,12,13,14,15,24,25,26,27,],
    [32,33,34,35,37,38,50,51,52,53,54,55,56,],[36,61,62,63,64,380,],[39,40,41,42,43,44,45,46,47,48,49,57,58,59,60,],
    [65,66,67,68,70,71,80,81,82,83,84,85,86,],[69,91,92,93,94,381,],[72,73,74,75,76,77,78,79,87,88,89,90,],
    [95,96,97,98,100,101,113,114,115,116,117,118,119,],[99,124,125,126,127,382,],
    [102,103,104,105,106,107,108,109,110,111,112,120,121,122,123,],[128,129,130,131,133,134,145,146,147,148,149,150,151,],
    [132,156,157,158,159,383,],[135,136,137,138,139,140,141,142,143,144,152,153,154,155,],[160,161,162,163,165,166,177,178,179,180,181,182,183,],[164,188,189,190,191,384,],[167,168,169,170,171,172,173,174,175,176,184,185,186,187,],[192,193,194,195,197,198,208,209,210,211,212,213,214,],[196,220,221,222,223,385,],[199,200,201,202,203,204,205,206,207,215,216,217,218,219,],[224,225,226,227,229,230,240,241,242,243,244,245,246,],[228,252,253,254,255,386,],[231,232,233,234,235,236,237,238,239,247,248,249,250,251,],[256,257,258,259,261,262,271,272,273,274,275,276,277,],[260,282,283,284,285,387,],[263,264,265,266,267,268,269,270,278,279,280,281,],[286,287,288,289,291,292,304,305,306,307,308,309,310,],[290,315,316,317,318,388,],[293,294,295,296,297,298,299,300,301,302,303,311,312,313,314,],[319,320,321,322,324,325,334,335,336,337,338,339,340,],[323,345,346,347,348,389,],[326,327,328,329,330,331,332,333,341,342,343,344,],[349,350,351,352,354,355,367,368,369,370,371,372,374,],[353,373,],[356,357,358,359,360,361,362,363,364,365,366,375,376,377,378,],[390,412,],[391,392,393,394,396,397,406,407,408,409,410,411,413,],[395,418,419,420,421,769,],[398,399,400,401,402,403,404,405,414,415,416,417,],[422,423,424,425,427,428,440,441,442,443,444,445,446,],[426,451,452,453,454,770,],[429,430,431,432,433,434,435,436,437,438,439,447,448,449,450,],[455,456,457,458,460,461,470,471,472,473,474,475,476,],[459,481,482,483,484,771,],[462,463,464,465,466,467,468,469,477,478,479,480,],[485,486,487,488,490,491,503,504,505,506,507,508,509,],[489,514,515,516,517,772,],[492,493,494,495,496,497,498,499,500,501,502,510,511,512,513,],[518,519,520,521,523,524,535,536,537,538,539,540,541,],[522,546,547,548,549,773,],[525,526,527,528,529,530,531,532,533,534,542,543,544,545,],[550,551,552,553,555,556,567,568,569,570,571,572,573,],[554,578,579,580,581,774,],[557,558,559,560,561,562,563,564,565,566,574,575,576,577,],[582,583,584,585,587,588,598,599,600,601,602,603,604,],[586,610,611,612,613,775,],[589,590,591,592,593,594,595,596,597,605,606,607,608,609,],[614,615,616,617,619,620,630,631,632,633,634,635,636,],[618,642,643,644,645,776,],[621,622,623,624,625,626,627,628,629,637,638,639,640,641,],[646,647,648,649,651,652,661,662,663,664,665,666,667,],[650,672,673,674,675,777,],[653,654,655,656,657,658,659,660,668,669,670,671,],[676,677,678,679,681,682,694,695,696,697,698,699,700,],[680,705,706,707,708,778,],[683,684,685,686,687,688,689,690,691,692,693,701,702,703,704,],[709,710,711,712,714,715,724,725,726,727,728,729,730,],[713,735,736,737,738,779,],[716,717,718,719,720,721,722,723,731,732,733,734,],[739,740,741,742,744,745,757,758,759,760,761,762,764,],[743,763,],[746,747,748,749,750,751,752,753,754,755,756,765,766,767,768,],]

labelsB = []
for idx in range(len(fragsB)):
    labelsB.append('B%d' % (idx+1))

job_params = {
  "name": "fsapt-test",
  "version": "v1",
  "kind": "FSAPTCalculation",
  "parameters": {
        "molecule_a": {
            "base64data": monomerA,
            "filetype": "xyz",
            "params": {
                "charge": chargeA,
                "fragments": fragsA,
                "fragment_names": labelsA
            }
        },
        "molecule_b": {
            "base64data": monomerB,
            "filetype": "xyz",
            "params": {
                "charge": chargeB,
                "fragments": fragsB,
                "fragment_names": labelsB
            }
        },
        "system": {
            "params": {
                "basisname": "def2-svp",
                "methodname": "hf",
                "threshold_pq": 1e-10
            }
        },
        "jk_builder": {
#            "type": "core_dfjk",
#            "type": "dfj_grid_k",
            "type": "numerical_jk",
            "params": {}
        },
        "hf": {
            "params": {
                "g_convergence": 1.0e-6
            }
        }
  },
  "resources": {
    "gpu_type": gpu_type,
    "gpu_count": 1
  }
}

headers = {
    "x-api-key": os.environ["PM_API_KEY"],
    "accept": "application/json",
    "content-type": "application/json",
}

client = httpx.Client(base_url=base_url, headers=headers)

payload = job_params
jobname = payload["name"]
print(f"Submitting {jobname}...", end="")
response = client.post("/v0/workflows", json=payload)
response.raise_for_status()
with open(f"{foldername}/{jobname}_submitted.json", "w") as fp:
    fp.write(json.dumps(response.json()))
workflow_id = response.json()["id"]
print("done!")

workflow = wait_for_workflows_to_complete(
    client=client,
    workflow_ids=[workflow_id],
    log_events=["STATE_CHANGES"],
    timeout=3600,
)[workflow_id]
print(f"Workflow completed with status: {workflow['status']}")

response = client.get(f"/v0/workflows/{workflow_id}").json()
with open(f"{foldername}/{jobname}_status.json", "w") as fp:
    fp.write(json.dumps(response))
name = response["name"]
timetaken = response["duration_seconds"]
print(f"Name: {name}, time taken: {timetaken:.2f}s")

response = client.get(f"/v0/workflows/{workflow_id}/results").json()
with open(f"{foldername}/{jobname}_results.json", "w") as fp:
    fp.write(json.dumps(response))

response = client.get(
    f"/v0/workflows/{workflow_id}/results/download", follow_redirects=True
)
with open(f"{foldername}/{jobname}_results.zip", "wb") as fp:
    fp.write(response.content)

response = client.get(f"/v0/workflows/{workflow_id}/results").json()

labels_a = response['results']['fsapt']['fragment_labels']['molecule_a']
labels_b = response['results']['fsapt']['fragment_labels']['molecule_b']

Eelst = 627.5095 * np.array(response['results']['fsapt']['tensors']['Eelst'])
Eexch = 627.5095 * np.array(response['results']['fsapt']['tensors']['Eexch'])
EindAB = 627.5095 * np.array(response['results']['fsapt']['tensors']['EindAB'])
EindBA = 627.5095 * np.array(response['results']['fsapt']['tensors']['EindBA'])
Edisp = 627.5095 * np.array(response['results']['fsapt']['tensors']['Edisp'])
Esapt = 627.5095 * np.array(response['results']['fsapt']['tensors']['Esapt'])

print('')
print('F-SAPT Analysis (kcal / mol)')
print('')
print('Frag1     Frag2         Elst     Exch    IndAB    IndBA     Disp    Total')
for i in range(len(labels_a)):
    for j in range(len(labels_b)):
        print('%-9s %-9s %8.3lf %8.3lf %8.3lf %8.3lf %8.3lf %8.3lf' % (labels_a[i], labels_b[j], Eelst[i,j], Eexch[i,j], EindAB[i,j], EindBA[i,j], Edisp[i,j], Esapt[i,j]))

for i in range(len(labels_a)):
    print('%-9s %-9s %8.3lf %8.3lf %8.3lf %8.3lf %8.3lf %8.3lf' % (labels_a[i], 'All', np.sum(Eelst, axis=1)[i], np.sum(Eexch, axis=1)[i], np.sum(EindAB, axis=1)[i], np.sum(EindBA, axis=1)[i], np.sum(Edisp, axis=1)[i], np.sum(Esapt, axis=1)[i]))

for i in range(len(labels_b)):
    print('%-9s %-9s %8.3lf %8.3lf %8.3lf %8.3lf %8.3lf %8.3lf' % ('All', labels_b[i], np.sum(Eelst, axis=0)[i], np.sum(Eexch, axis=0)[i], np.sum(EindAB, axis=0)[i], np.sum(EindBA, axis=0)[i], np.sum(Edisp, axis=0)[i], np.sum(Esapt, axis=0)[i]))

print('%-9s %-9s %8.3lf %8.3lf %8.3lf %8.3lf %8.3lf %8.3lf' % ('All', 'All', np.sum(Eelst), np.sum(Eexch), np.sum(EindAB), np.sum(EindBA), np.sum(Edisp), np.sum(Esapt)))

